Methods Materials. All chemicals with analytical-grade purity were purchased and used directly without further treatment unless otherwise noted. All solutions were prepared with ultrapure water. Commercial Pd/C (10 wt%, 8 nm Pd particles on activated carbon, Aldrich) and Pt/C (20 wt%, 3 nm Pt particles on carbon black, Johnson Matthey) were used as baseline catalysts. Nafion solution (5.0 wt%), carbon paper (TGP-H-060) and anion-exchange membranes (Fumasep FAS-PET-75) were purchased from the Fuel Cell Store. Vulcan XC-72 carbon black (Fuel Cell Earth) was used as the catalyst support.

Synthesis of heteroatom X-doped carbon (X–C, X = N, P, S, B, F). First, 0.2 g O–C and 1.0 g melamine (C 3 H 6 N 6 ) were ground together in an agate mortar for 1 h and then pyrolysed at 900 °C for 2 h in an argon atmosphere. After cooling to room temperature, N–C was obtained by washing with ethanol and water. The same method was used to synthesize P–C, S–C, B–C and F–C with sodium hypophosphite anhydrous (NaH 2 PO 2 , 98%), sulfur powder (99.5%), boracic acid (H 3 BO 3 , 99.5%) and polyvinylidene difluoride (PVDF, 99%) as P, S, B and F sources, respectively. Note that the temperature for the synthesis of B–C was 1,000 °C (ref. 44).

Synthesis of heteroatom X–F-codoped carbon (X&F–C, X = N, P, S, B). First, 0.1 g N–C and 0.8 g PVDF were ground together in an agate mortar for 1 h and then added into a solution consisting of 30 ml acetone and 10 ml H 2 O. After sonication for 0.5 h, the mixture was refluxed at 120 °C in an oil bath until fully dried. The mixture was further pyrolysed at 600 °C for 2 h in an argon atmosphere.